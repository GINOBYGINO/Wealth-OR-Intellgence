<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wealth or IQ | 財命交換所</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-color: #000000;
            --text-color: #ffffff;
            --accent-color: #ffffff;
            --border-color: #222222;
            --secondary-text: #888888;
            --highlight: #ff3e3e;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 600px;
            width: 100%;
            padding-bottom: 50px;
        }

        header {
            text-align: center;
            margin: 40px 0;
        }

        h1 {
            font-weight: 200;
            font-size: 1.8rem;
            letter-spacing: 0.15em;
            margin-bottom: 10px;
        }

        .desc {
            color: var(--secondary-text);
            font-size: 0.9rem;
        }

        /* 輸入區塊 */
        .input-section {
            background: #0a0a0a;
            padding: 30px 20px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
            margin-bottom: 30px;
        }

        .input-hint {
            font-size: 0.85rem;
            text-align: center;
            color: #ccc;
        }

        .input-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
        }

        input[type="number"] {
            background: transparent;
            border: none;
            border-bottom: 2px solid var(--accent-color);
            color: white;
            font-size: 2rem;
            text-align: center;
            width: 100px;
            padding: 5px;
            outline: none;
            font-family: serif;
        }

        button {
            background: white;
            color: black;
            border: none;
            padding: 15px 40px;
            font-size: 1rem;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            width: 100%;
            max-width: 200px;
            transition: transform 0.1s;
        }

        button:active { transform: scale(0.98); }

        /* 結果顯示區 */
        #result-area {
            display: none;
            animation: fadeIn 0.6s ease-out;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin: 30px 0;
        }

        .stat-card {
            background: #0a0a0a;
            padding: 15px 5px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--secondary-text);
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .stat-value {
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* 圖表與表格 */
        .chart-container {
            height: 320px;
            margin: 20px 0;
            background: #050505;
            padding: 10px;
            border: 1px solid var(--border-color);
        }

        .table-scroll {
            overflow-x: auto;
            margin: 20px 0;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 450px;
            font-size: 0.85rem;
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: 12px 10px;
            text-align: left;
        }

        th { color: var(--secondary-text); font-weight: 400; }

        .reset-btn {
            background: transparent;
            color: var(--secondary-text);
            border: 1px solid #333;
            margin-top: 30px;
            width: auto;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 手機版適配 */
        @media (max-width: 480px) {
            .stats-grid { grid-template-columns: 1fr; }
            .stat-card { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; }
            .stat-label { margin-bottom: 0; }
            h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>WEALTH OR IQ</h1>
            <p class="desc">交換代價：出身決定財富，也決定了你的起點智力。</p>
        </header>

        <div class="input-section" id="input-group">
            <p class="input-hint">
                你想出生在世界財富前 N%？<br>
                <small style="color:#ececec; margin-top:5px; display:block;">但智商會變為 60 × 3<sup>(N/100)</sup></small>
            </p>
            <div class="input-wrapper">
                <span>N =</span>
                <input type="number" id="n-value" placeholder="1.0" min="0.0" max="100" step="1.0" inputmode="decimal">
                <span>%</span>
            </div>
            <button onclick="calculate()">計算結果</button>
        </div>

        <div id="result-area">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">預計智商</div>
                    <div class="stat-value" id="res-iq">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">財富排名</div>
                    <div class="stat-value" id="res-percent">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">預估資產</div>
                    <div class="stat-value" id="res-wealth">-</div>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="mainChart"></canvas>
            </div>

            <h3 style="font-size: 1rem; font-weight: 300; margin-top: 40px;">全球財富金字塔參考 (2025)</h3>
            <div class="table-scroll">
                <table>
                    <thead>
                        <tr>
                            <th>財富階層 (Top %)</th>
                            <th>資產 (USD)</th>
                            <th>對應 IQ</th>
                        </tr>
                    </thead>
                    <tbody id="reference-table">
                        </tbody>
                </table>
            </div>

            <div style="text-align: center;">
                <button class="reset-btn" onclick="reset()">重新輸入</button>
            </div>
        </div>
    </div>

    <script>
        let myChart = null;

        // 財富估計函數 (單位：千美元)
        function getWealth(n) {
            if (n <= 0.1) return 50000; // 封頂顯示
            if (n <= 1) return 1200 * Math.pow(40, (1 - n)); 
            if (n <= 10) return 1200 - (n - 1) * (1050 / 9);
            if (n <= 50) return 150 - (n - 10) * (140 / 40);
            return 10 * Math.pow(0.92, (n - 50));
        }

        // 智商函數：60 * 3^(N/100)
        function getIQ(n) {
            return 60 * Math.pow(3, (n / 100));
        }

        function calculate() {
            const n = parseFloat(document.getElementById('n-value').value);
            if (isNaN(n) || n < 0 || n > 100) {
                alert("請輸入 0 到 100 之間的數值");
                return;
            }

            const iq = getIQ(n);
            const wealth = getWealth(n);

            document.getElementById('res-iq').innerText = Math.round(iq);
            document.getElementById('res-percent').innerText = `Top ${n}%`;
            document.getElementById('res-wealth').innerText = `$${(wealth * 1000).toLocaleString()}`;

            document.getElementById('input-group').style.display = 'none';
            document.getElementById('result-area').style.display = 'block';

            renderTable();
            renderChart(n);
        }

        function renderTable() {
            const levels = [1, 10, 20, 50,70,90];
            const html = levels.map(l => `
                <tr>
                    <td>Top ${l}%</td>
                    <td>$${(getWealth(l)*1000).toLocaleString()}</td>
                    <td>${Math.round(getIQ(l))}</td>
                </tr>
            `).join('');
            document.getElementById('reference-table').innerHTML = html;
        }

        function renderChart(userN) {
            const labels = [];
            const iqData = [];
            const wealthData = [];

            for (let i = 0.5; i <= 100; i += 2) {
                labels.push(i);
                iqData.push(getIQ(i));
                wealthData.push(getWealth(i));
            }

            const ctx = document.getElementById('mainChart').getContext('2d');
            if (myChart) myChart.destroy();

            Chart.defaults.color = '#666';
            Chart.defaults.font.size = 10;

            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'IQ',
                            data: iqData,
                            borderColor: '#ffffff',
                            borderWidth: 1.5,
                            yAxisID: 'yIQ',
                            pointRadius: 0
                        },
                        {
                            label: '財富(k)',
                            data: wealthData,
                            borderColor: '#444',
                            borderWidth: 1.5,
                            yAxisID: 'yWealth',
                            pointRadius: 0
                        },
                        {
                            label: 'YOU',
                            data: [{x: userN, y: getIQ(userN)}],
                            backgroundColor: '#ff3e3e',
                            pointRadius: 6,
                            type: 'scatter',
                            yAxisID: 'yIQ'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { 
                            title: { display: true, text: 'Top N%' },
                            grid: { color: '#111' }
                        },
                        yIQ: {
                            position: 'left',
                            title: { display: true, text: 'IQ', color: '#fff' },
                            grid: { color: '#111' }
                        },
                        yWealth: {
                            type: 'logarithmic',
                            position: 'right',
                            grid: { display: false },
                            ticks: { callback: v => '$' + v + 'k' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function reset() {
            document.getElementById('input-group').style.display = 'flex';
            document.getElementById('result-area').style.display = 'none';
            document.getElementById('n-value').value = '';
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
